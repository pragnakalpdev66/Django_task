{% extends 'movies/base.html' %}

{% block title %}6.People (Actor/Director) {% endblock %}

{% block content %}
<div class="people-container">
    <div class="head-content">
        <h1>All People</h1>
        <button><a class="nav-link" href="{% url 'movies:addpeople' %}">+ Add New Person</a></button>
    </div>
    <br>

    <form class="search-person" method="get" action="{% url 'movies:people' %}" role="search">
        <div class="role-type">
            <label for="role_type">Role Type</label>
            {% comment %} <select id="role_type" name="role_type">
                {% for value, label in person.role_type.choices %}
                    <option value="{{ value }}">{{ label }}</option>
                {% endfor %}
            </select> {% endcomment %}
            <select class="form-select" name="role_type">
                <option value="all">All Roles</option>
                <option value="actor">Actor</option>
                <option value="director">Director</option>
                <option value="writer">Writer</option>
            </select>
        </div>
        <div class="search-input">
            <label for="search_person">Search</label>
            <input type="search" name="search_person" value="{{ request.GET.search_person|default:'' }}" placeholder="Search by name..."/>
        </div>
        <div class="btn-apply-filter">
            <button type="submit">Apply Filters</button>
        </div>
    </form>
    <hr>

    <div class="people-section">
        {% for person in people %}
        <div class="person-card">
            <a class="nav-link" href="{% url 'movies:personDetail' person.id %}">
                <div class="person-profile">{{ person.profile_photo }}</div>
                <div class="person-info">
                    <h3>{{ person.person_name }}</h3>
                    <p><span>{{ person.role_type }}</span></p>
                    <p>Born: {{ person.birth_date }}</p>
                    <p>{{ person.moviecast_set.count }} {{ person.directed_movies.count }} movies acted/directed</p>
                </div>
            </a>
            <div class="action-btn">
                <button><a href="{% url 'movies:personDetail' person.id %}">View</a></button>
                <button><a href="{% url 'movies:editpeople' person.id %}">Edit</a></button>
                <button><a href="{% url 'movies:deletepeople' pk=person.id %}">Delete</a></button>
            </div>
            <hr>
        </div>
        {% empty %}
        <p>No person found.</p>
        {% endfor %}
    </div>
</div>
{% endblock content %}
<form class="search-box" method="get" role="search" action="{% if movie %}{% url 'movies:movie' %}{% elif person %}{% url 'movies:people' %}{% endif %}" >
            <input class="search-input" name="search_movie" type="search" value="{% if movie %}{{ request.GET.search_movie }}{% elif person %}{{ request.GET.search_person }}{% endif %}" placeholder="Search for movies, actors, directors..."/ required>
            <button class="btn" type="submit">Search</button>
        </form>